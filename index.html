<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>cms-5000</title>
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="css/style.css">
  <script src="js/libs/jquery-1.11.1.min.js"></script>
  <script src="js/libs/ember-template-compiler-1.10.0.js"></script>
  <script src="js/libs/handlebars-v1.3.0.js"></script>
  <script src="js/libs/ember-1.10.0.min.js"></script>
  <script src="js/libs/ember-data-1.0.0-beta-15.min.js"></script>
  <script src="js/libs/ember-shortcuts.js"></script>
  <script src="js/libs/ember-localstorage_adapter.js"></script>
  <script src="js/libs/showdown-0.3.1.min.js"></script>
  <script src="js/libs/moment.min.js"></script>
  <script src="js/libs/pouchdb-3.3.0.min.js"></script>
  <script src="js/libs/pouchdb.relational-pouch.min.js"></script>
  <script src="js/libs/main.js"></script>
  <script src="js/libs/bootstrap.min.js"></script>
  <script src="js/app.js"></script>
  <script src="js/script.js"></script>
  <script src="js/models/post.js"></script>
  <script src="js/models/page.js"></script>
  <script src="js/search.js"></script>
  <script src="js/couchDB.js"></script>
</head>

<body>
  <script type="text/x-handlebars">
    <div class="container-fluid">
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          <div class="navbar-header">
            {{#link-to 'posts' class='navbar-brand'}}cms-5000{{/link-to}}
          </div>
          <ul class="nav navbar-nav">
            <li>{{#link-to 'pages'}}Pages{{/link-to}}</li>
            <li>{{#link-to 'search'}}Search{{/link-to}}</li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <form class="navbar-form searchbox" role="search">
                <input type="text" class="form-control">
                <button type="submit" class="btn btn-default"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
              </form>
            </li>
            <li>{{#link-to 'add-post'}}Add a Post{{/link-to}}</li>
            <li>{{#link-to 'add-page'}}Add a Page{{/link-to}}</li>
            <li class="dropdown">
              <a href="" class="dropdown-toggle" data-toggle="dropdown">Login <b class="caret"></b></a>
              <ul class="dropdown-menu" style="padding: 15px 15px 0 15px; min-width: 280px;">
                <li>
                  <form class="form" role="form" method="post" action="login" accept-charset="UTF-8" id="login-nav">
                    <div class="form-group">
                      <label class="sr-only" for="login-email">Email Address</label>
                      <input type="email" class="form-control" id="login-email" placeholder="Email Address" required>
                    </div>
                    <div class="form-group">
                      <label class="sr-only" for="login-password">Password</label>
                      <input type="password" class="form-control" id="login-password" placeholder="Password" required>
                    </div>
                    <div class="form-group">
                      <button {{action 'login'}} class="btn btn-success btn-block">
                        <span class="glyphicon glyphicon-lock" aria-hidden="true"></span> Login
                      </button>
                    </div>
                  </form>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
      <div class="row">
        <div class="col-md-offset-2 col-md-8 col-xs-12">
          {{outlet 'alert'}}
          {{outlet}}
        </div>
      </div>
    </div>
  </script>
  
  <script type="text/x-handlebars" data-template-name="alert">
    <div class="alert alert-{{view.class}}" role="alert">{{view.message}}</div>
  </script>
    
  <script type="text/x-handlebars" id="posts">
    {{#each post in model itemController="post"}}
      <article class="post">
        {{#if post.isEditing}}
          {{post-editor post=post editPost='editPost' toggleEdit='toggleEdit' removePost='removePost'}}
        {{else}}
          {{post-viewer post=post toggleEdit='toggleEdit'}}
        {{/if}}
        </article>
      {{else}}
        <p class="info">There aren&#31;t any posts yet.</p>
        {{#link-to 'add-post' class='btn btn-primary'}}Add a Post{{/link-to}}
      {{/each}}
  </script>
  
  <script type="text/x-handlebars" id="post">
    {{#if isEditing}}
      {{post-editor post=this editPost='editPost' toggleEdit='toggleEdit' removePost='removePost'}}
    {{else}}
      {{post-viewer post=this toggleEdit='toggleEdit' single=true}}
    {{/if}}
  </script>
  
  <script type="text/x-handlebars" id="components/post-viewer">
    <article class="post">
      {{#if single}}
        <h1>{{post.title}}</h1>
      {{else}}
        {{#link-to 'post' post.id}}<h1>{{post.title}}</h1>{{/link-to}}
      {{/if}}
      <p class="excerpt">{{format-markdown post.excerpt}}</p>
      {{#if single}}
        <p class="body">{{format-markdown post.body}}</p>
      {{else}}
        {{#if post.body}}
          <p class="body">{{#link-to 'post' post.id}}Read more{{/link-to}}</p>
        {{/if}}
      {{/if}}
      <p class="date">{{format-date post.date}}</p>
      <p class="tags">Tags: <span class="tags-content">{{post.tags}}</span></p>
      <!-- TODO: Only show edit button for admins. -->
      <button type="button" {{action 'toggleEdit' post}} class="btn btn-default" title="Edit this post.">
        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
      </button>
    </article>
  </script>
  
  <script type="text/x-handlebars" id="components/post-editor">
    <div class="post-editing" role="tabpanel">
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#editor" aria-controls="editor" role="tab" data-toggle="tab">Editor</a></li>
        <li role="presentation"><a href="#preview" aria-controls="preview" role="tab" data-toggle="tab">Preview</a></li>
      </ul>
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="editor" style="margin-top: 10px;">
          <p>{{input type="text" value=post.title class="form-control input-lg" placeholder="Title*"}}</p>
          <p>{{input type="text" value=post.slug class="form-control" placeholder="Slug (Short URL)*"}}</p>
          <label for="excerpt">Excerpt*</label>
          <p>{{textarea value=post.excerpt cols="80" rows="4" class="form-control" id="excerpt"}}</p>
          <label for="body">Content</label>
          <p>{{textarea value=post.body cols="80" rows="4" class="form-control" id="body"}}</p>
          <label for="Tags">Tags</label> <small>(Seperate with commas.)</small>
          <p>{{input type="text" value=post.tags class="form-control" id="tags"}}</p>
        </div>
        <div role="tabpanel" class="tab-pane" id="preview">
          <h1>{{title}}</h1>
          <p class="excerpt">{{format-markdown post.excerpt}}</p>
          <p class="body">{{format-markdown post.body}}</p>
          <p class="metadata">{{format-date post.date}}</p>
          {{#if post.tags}}
            <p class="tags">Tags: <span class="tags-content">{{post.tags}}</span></p>
          {{/if}}
        </div>
      </div>
      <button {{action 'editPost' post}} class="btn btn-success">
        <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Save
      </button>
      <button {{action 'toggleEdit' post}} class="btn btn-default">
        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Cancel
      </button>
      <button {{action 'removePost' post}} class="btn btn-danger pull-right">
        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Delete
      </button>
    </div>
  </script>
  
  <script type="text/x-handlebars" id="add-post">
    <h1>Add a Post</h1>
    <div role="tabpanel">
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#newEditor" aria-controls="newEditor" role="tab" data-toggle="tab">Editor</a></li>
        <li role="presentation"><a href="#newPreview" aria-controls="newPreview" role="tab" data-toggle="tab">Preview</a></li>
      </ul>
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="newEditor" style="margin-top: 10px;">
          <p>{{input type="text" value=newTitle class="form-control input-lg" placeholder="Title*"}}</p>
          <p>{{input type="text" value=newSlug class="form-control" placeholder="Slug (Short URL)*"}}</p>
          <label for="newExcerpt">Excerpt*</label>
          <p>{{textarea value=newExcerpt cols="80" rows="4" class="form-control" id="newExcerpt"}}</p>
          <label for="newBody">Content</label>
          <p>{{textarea value=newBody cols="80" rows="4" class="form-control" id="newBody"}}</p>
          <label for="newTags">Tags</label> <small>(Seperate with commas.)</small>
          <p>{{input type="text" value=newTags class="form-control" id="newTags"}}</p>
        </div>
        <div role="tabpanel" class="tab-pane" id="newPreview">
          <h1>{{newTitle}}</h1>
          <p class="excerpt">{{format-markdown newExcerpt}}</p>
          {{#if newBody}}
            <p class="body">{{format-markdown newBody}}</p>
          {{else}}
            <p class="body" style="color: #aaa">(No content.)</p>
          {{/if}}
          {{#if newTags}}
            <p class="tags">Tags: <span class="tags-content">{{newTags}}</span></p>
          {{/if}}
        </div>
      </div>
    </div>
    <button {{action 'addPost'}} class="btn btn-success">
      <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Save &amp; Publish
    </button>
    {{#link-to 'posts' class="btn btn-default" role="button"}}<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Cancel{{/link-to}}
  </script>
  
  <script type="text/x-handlebars" id="pages">
    {{#each page in model}}
      {{#link-to 'page' page.id}}{{page.title}}{{/link-to}}
    {{else}}
      <p class="info">There aren't any pages yet.</p>
      {{#link-to 'add-page' class='btn btn-primary'}}Add a Page{{/link-to}}
    {{/each}}
    
  </script>
  
  <script type="text/x-handlebars" id="page">
    {{#if isEditing}}
      {{page-editor page=this editPage='editPage' toggleEdit='toggleEdit' removePage='removePage'}}
    {{else}}
      {{page-viewer page=this toggleEdit='toggleEdit' single=true}}
    {{/if}}
  </script>
  
  <script type="text/x-handlebars" id="add-page">
<!--    {{page-editor addPage='addPage' page=null new=true}}-->
    <h1>Add a Page</h1>
    <div role="tabpanel">
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#newEditorPage" aria-controls="newEditorPage" role="tab" data-toggle="tab">Editor</a></li>
        <li role="presentation"><a href="#newPreviewPage" aria-controls="newPreviewPage" role="tab" data-toggle="tab">Preview</a></li>
      </ul>
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="newEditorPage" style="margin-top: 10px;">
          <p>{{input type="text" value=newPageTitle class="form-control input-lg" placeholder="Title*"}}</p>
          <p>{{input type="text" value=newPageSlug class="form-control" placeholder="Slug (Short URL)*"}}</p>
          <label for="newBody">Content*</label>
          <p>{{textarea value=newPageBody cols="80" rows="6" class="form-control" id="newPageBody"}}</p>
        </div>
        <div role="tabpanel" class="tab-pane" id="newPreviewPage">
          <h1>{{newPageTitle}}</h1>
          <p class="body">{{format-markdown newPageBody}}</p>
        </div>
      </div>
    </div>
    <button {{action 'addPage'}} class="btn btn-success">
      <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Save &amp; Publish
    </button>
    {{#link-to 'posts' class="btn btn-default" role="button"}}<span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Cancel{{/link-to}}
  </script>
  
  <script type="text/x-handlebars" id="components/page-viewer">
    <article class="page">
      <h1>{{page.title}}</h1>
      <p class="body">{{format-markdown page.body}}</p>
      <!-- TODO: Only show edit button for admins. -->
      <button type="button" {{action 'toggleEdit' page}} class="btn btn-default" title="Edit this page.">
        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
      </button>
    </article>
  </script>
    
  <script type="text/x-handlebars" id="components/page-editor">
    <div role="tabpanel">
      <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#editorPage" aria-controls="editorPage" role="tab" data-toggle="tab">Editor</a></li>
        <li role="presentation"><a href="#previewPage" aria-controls="previewPage" role="tab" data-toggle="tab">Preview</a></li>
      </ul>
      <div class="tab-content">
        <div role="tabpanel" class="tab-pane active" id="editorPage" style="margin-top: 10px;">
          <p>{{input type="text" value=page.title class="form-control input-lg" placeholder="Title*"}}</p>
          <p>{{input type="text" value=page.slug class="form-control" placeholder="Slug (Short URL)*"}}</p>
          <label for="body">Content*</label>
          <p>{{textarea value=page.body cols="80" rows="6" class="form-control" id="body"}}</p>
        </div>
        <div role="tabpanel" class="tab-pane" id="previewPage">
          <h1>{{page.title}}</h1>
          <p class="body">{{format-markdown page.body}}</p>
        </div>
      </div>
    </div>
    <button {{action 'editPage' page}} class="btn btn-success">
      <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Save
    </button>
    <button {{action 'toggleEdit' page}} class="btn btn-default">
      <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Cancel
    </button>
    <button {{action 'removePage' page}} class="btn btn-danger pull-right">
      <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Delete
    </button>
  </script>

<script type="text/x-handlebars" id="search">
      {{#each post in model itemController="post"}}
        <article class="post">
        {{#if post.isEditing}}
          {{post-editor post=post editPost='editPost' toggleEdit='toggleEdit' removePost='removePost'}}
        {{else}}
          {{post-viewer post=post toggleEdit='toggleEdit'}}
        {{/if}}
        </article>
      {{else}}
        <p class="info">There aren&#31;t any posts yet.</p>
        {{#link-to 'add-post' class='btn btn-primary'}}Add a Post{{/link-to}}
      {{/each}}
  </script>
  
</body>

</html>
